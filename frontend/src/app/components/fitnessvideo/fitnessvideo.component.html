<div class="sm:text-center aclonica-font fondo_bk overflow-auto">
  <h1 class="text-center mb-4">FIT<span class="text-red-600">NESS</span></h1>

  <!-- Buscador de videos -->
  <app-searchbar [todos]="todos" (filteredItemsChanged)="onFilteredItemsChanged($event)"></app-searchbar>
  <!-- Admin tools -->
  <div class="flex flex-col justify-center items-center mb-4" *ngIf="role == 'admin'">
    <!-- Botón para activar el modo admin -->
    <div
      class="border-solid border-2 w-44 bg-red-800 rounded-full hover:bg-red-900 transition duration-300 hover:scale-105 items-center "
      role="button" (click)="toggleAdminMode()">
      <img src="../../../assets/img/svg/bxl-dev-to.svg" alt="configAdmin.svg" class="w-14 mx-auto">
      <p class="text-white">MODE</p>
    </div>
    <button *ngIf="adminModeActivated"
      class="bg-transparent rounded-full w-52 mx-3 px-1 py-1 text-green-500 border border-solid border-green-500 hover:scale-125 transition-transform duration-300 mt-2"
      (click)="addVideo()">Agregar video
    </button>
  </div>
  <!-- Filter buttons -->
  <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 sm:gap-4 sm:px-96 pb-20 px-10">
    <!-- Button to filter all videos -->
    <button class="bg-gray-400 text-black rounded-lg hover:bg-gray-300" [class.active]="selectedType === 'Todos'"
      (click)="filterVideos('Todos')">Todos</button>

    <!-- Button to filter videos with equipment -->
    <button class="bg-gray-400 text-black rounded-lg hover:bg-gray-300"
      [class.active]="selectedType === 'ConEquipamiento'" (click)="filterVideos('ConEquipamiento')">Con
      Equipamiento</button>

    <!-- Button to filter videos without equipment -->
    <button class="bg-gray-400 text-black rounded-lg hover:bg-gray-300"
      [class.active]="selectedType === 'SinEquipamiento'" (click)="filterVideos('SinEquipamiento')">Sin
      Equipamiento</button>
  </div>

  <!-- Modal para crear video -->
  <div *ngIf="createModal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-500 bg-opacity-50">
    <div class="bg-white rounded-lg p-6 w-2/3 mx-auto">
      <h2 class="text-xl font-semibold mb-4">Crear video</h2>
      <!-- Formulario para crear el video -->
      <form [formGroup]="createVideoForm" (submit)="submitCreateVideoForm()">
        <!-- Título -->
        <div class="mb-4">
          <label for="videoTitle" class="block text-black">Título del Video:</label>
          <input type="text" id="videoTitle" name="videoTitle" [(ngModel)]="editedVideo.title"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700"
            formControlName="videoTitle">
          <div class="mt-1">
            <!-- required error -->
            <span
              *ngIf="createVideoForm.get('videoTitle')?.hasError('required') && createVideoForm.get('videoTitle')?.touched"
              class="text-red-500">Campo
              obligatorio</span>
            <!-- invalid format error -->
            <span
              *ngIf="createVideoForm.get('videoTitle')!.hasError('pattern') && createVideoForm.get('videoTitle')?.dirty"
              class="text-red-500">Formato
              incorrecto</span>
          </div>
        </div>
        <!-- Entrenador -->
        <div class="mb-4">
          <label for="videoCoach" class="block text-black">Entrenador:</label>
          <input type="text" id="videoCoach" name="videoCoach" [(ngModel)]="editedVideo.coach"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700"
            formControlName="videoCoach">
          <div class="mt-1">
            <!-- required error -->
            <span
              *ngIf="createVideoForm.get('videoCoach')?.hasError('required') && createVideoForm.get('videoCoach')?.touched"
              class="text-red-500">Campo
              obligatorio</span>
            <!-- invalid format error -->
            <span
              *ngIf="createVideoForm.get('videoCoach')!.hasError('pattern') && createVideoForm.get('videoCoach')?.dirty"
              class="text-red-500">Formato
              incorrecto</span>
          </div>
        </div>
        <!-- Descripción -->
        <div class="mb-4">
          <label for="videoDescription" class="block text-black">Descripción del Video:</label>
          <textarea id="videoDescription" name="videoDescription" [(ngModel)]="editedVideo.description"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700"
            formControlName="videoDescription"></textarea>
          <div class="mt-1">
            <!-- required error -->
            <span
              *ngIf="createVideoForm.get('videoDescription')?.hasError('required') && createVideoForm.get('videoDescription')?.touched"
              class="text-red-500">Campo
              obligatorio</span>
            <!-- invalid format error -->
            <span
              *ngIf="createVideoForm.get('videoDescription')!.hasError('pattern') && createVideoForm.get('videoDescription')?.dirty"
              class="text-red-500">Formato
              incorrecto</span>
          </div>
        </div>
        <!-- URL -->
        <div class="mb-4">
          <label for="videoUrl" class="block text-black">URL del Video:</label>
          <input type="text" id="videoUrl" name="videoUrl" [(ngModel)]="editedVideo.url"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700"
            formControlName="videoUrl">
          <div class="mt-1">
            <!-- required error -->
            <span
              *ngIf="createVideoForm.get('videoUrl')?.hasError('required') && createVideoForm.get('videoUrl')?.touched"
              class="text-red-500">Campo
              obligatorio</span>
            <!-- invalid format error -->
            <span *ngIf="createVideoForm.get('videoUrl')!.hasError('pattern') && createVideoForm.get('videoUrl')?.dirty"
              class="text-red-500">Formato
              incorrecto</span>
          </div>
        </div>
        <!-- Duración -->
        <div class="mb-4">
          <label for="videoDuration" class="block text-black">Duración:</label>
          <input type="text" id="videoDuration" name="videoDuration" [(ngModel)]="editedVideo.duration"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700"
            formControlName="videoDuration">
          <div class="mt-1">
            <!-- required error -->
            <span
              *ngIf="createVideoForm.get('videoDuration')?.hasError('required') && createVideoForm.get('videoDuration')?.touched"
              class="text-red-500">Campo
              obligatorio</span>
            <!-- invalid format error -->
            <span
              *ngIf="createVideoForm.get('videoDuration')!.hasError('pattern') && createVideoForm.get('videoDuration')?.dirty"
              class="text-red-500">Formato
              incorrecto</span>
          </div>
        </div>
        <!-- Exclusivo -->
        <div class="mb-4">
          <label for="videoExclusive" class="block text-black">Exclusivo:</label>
          <input type="checkbox" id="videoExclusive" name="videoExclusive" [(ngModel)]="editedVideo.exclusive"
            class="border-gray-300 border rounded-lg px-4 py-2 text-center text-red-700"
            formControlName="videoExclusive">
        </div>
        <!-- Botones de acción -->
        <div class="flex justify-center">
          <button type="button" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-lg mr-2"
            (click)="closeCreateModal()">Cancelar</button>
          <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded-lg"
            [disabled]="createVideoForm.invalid">Guardar Cambios</button>
        </div>
      </form>
    </div>
  </div>
  <!-- end modal para crear video -->

  <!-- edit video modal -->
  <div *ngIf="editModal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-500 bg-opacity-50">
    <div class="bg-white rounded-lg p-6 w-2/3 mx-auto">
      <h2 class="text-xl font-semibold mb-4">Edit <span class="text-red-600">{{ editedVideo.title }}</span></h2>
      <form (submit)="submitEditVideoForm()">
        <!-- Title -->
        <div class="mb-4">
          <label for="videoTitle" class="block text-black">Title:</label>
          <input type="text" id="videoTitle" name="videoTitle" [(ngModel)]="editedVideo.title"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700">
        </div>
        <!-- Coach -->
        <div class="mb-4">
          <label for="videoCoach" class="block text-black">Coach:</label>
          <input type="text" id="videoCoach" name="videoCoach" [(ngModel)]="editedVideo.coach"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700">
        </div>
        <!-- Description -->
        <div class="mb-4">
          <label for="videoDescription" class="block text-black">Description:</label>
          <textarea id="videoDescription" name="videoDescription" [(ngModel)]="editedVideo.description"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700 h-52"></textarea>
        </div>
        <!-- URL -->
        <div class="mb-4">
          <label for="videoUrl" class="block text-black">URL:</label>
          <input type="text" id="videoUrl" name="videoUrl" [(ngModel)]="editedVideo.url"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700">
        </div>
        <!-- Duración -->
        <div class="mb-4">
          <label for="videoDuration" class="block text-black">Duración:</label>
          <input type="text" id="videoDuration" name="videoDuration" [(ngModel)]="editedVideo.duration"
            class="border-gray-300 border w-full rounded-lg px-4 py-2 text-center text-red-700">
        </div>
        <!-- Exclusivo -->
        <div class="mb-4">
          <label for="videoExclusive" class="block text-black">Exclusivo:</label>
          <input type="checkbox" id="videoExclusive" name="videoExclusive" [(ngModel)]="editedVideo.exclusive"
            class="border-gray-300 border rounded-lg px-4 py-2 text-center text-red-700">
        </div>
        <!-- Buttons -->
        <div class="flex justify-center">
          <button type="button" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-lg mr-2"
            (click)="closeEditModal()">Cancel</button>
          <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded-lg">Guardar Cambios</button>
        </div>
      </form>
    </div>
  </div>
  <!-- end edit video modal -->
  <!-- delet e modal -->
  <div *ngIf="deleteModal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-500 bg-opacity-50">
    <div class="bg-white rounded-lg p-6 max-w-md mx-auto">
      <h2 *ngIf="selectedVideo !== null" class="text-xl font-semibold mb-4">Eliminar <b class="text-red-600">
          {{selectedVideo.title}}</b></h2>
      <p *ngIf="selectedVideo !== null">¿Estás seguro de que quieres eliminar el producto con ID <span
          class="text-red-600">
          {{selectedVideo.id}}</span>?</p>
      <p *ngIf="selectedVideo === null">Por favor, selecciona un producto para eliminar.</p>
      <div class="flex justify-end mt-4">
        <button type="button" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-lg mr-2"
          (click)="cancelDelete()">Cancelar</button>
        <button type="button" class="bg-red-500 text-white px-4 py-2 rounded-lg"
          (click)="confirmDelete()">Eliminar</button>
      </div>
    </div>
  </div>
  <!-- end delete modal -->
  <!-- Lista de videos filtrados -->
  <div class="grid grid-cols-1 gap-4 sm:grid-cols-3 sm:gap-12 sm:px-96 pb-20 text-center sm:text-justify">
    <!-- Pantalla de carga mientras se obtiene los videos de fitness -->
    <div class="fixed inset-0 flex items-center justify-center shadow-xl" *ngIf="loading; else fitnessContainer">
      <div class="absolute h-12 w-12 rounded-full border-t-4 border-b-4 border-gray-200"></div>
      <div class="absolute h-12 w-12 rounded-full border-t-4 border-b-4 border-red-500 animate-spin"></div>
      <img src="../../../assets/img/my_logo.webp" class="rounded-full h-8 w-8">
    </div>
    <ng-template #fitnessContainer>
      <div class="group relative" *ngFor="let video of filteredItems">
        <!-- Mostrar solo si está en modo admin -->
        <div *ngIf="adminModeActivated">
          <div class="flex flex-row">
            <img src="../../../assets/img/svg/bx-edit.svg" (click)="editVideo(video.id)" alt="bx-edit" class="w-9 mx-2"
              role="button">
            <img src="../../../assets/img/svg/bx-trash.svg" (click)="openDeleteModal(video)" alt="bx-edit"
              class="w-9 mx-2" role="button">
          </div>
        </div>
        <ng-container>
          <a (click)="selectVideo(video)">
            <div class="premium-icon" *ngIf="video.exclusive">
              <img src="../../../assets/img/svg/star.svg" alt="Premium" class="star-icon">
            </div>
            <div class="flex items-center justify-center sm:justify-start">
              <img src="../../../assets/img/boxeopareja.webp"
                class="max-w-full sm:max-w-none transition duration-300 transform group-hover:scale-105">
            </div>
            <h3 class="text-lg font-bold sm:mt-4">{{video.title}}</h3>
          </a>
        </ng-container>
        <div [ngClass]="{'fixed inset-0 flex items-center justify-center z-50': modalOpen, 'hidden': !modalOpen}">
          <div class="absolute inset-0 bg-gray-500 opacity-10"></div>
          <div class="bg-white p-8 rounded-lg z-50">
            <h2 class="text-2xl font-bold mb-4">¡Ups!
              Contenido Premium</h2>
            <p>Este video es contenido
              premium. Para acceder, actualiza tu suscripción a standard o premium.</p>
            <button class="mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-blue-600 mx-1"
              (click)="closeModal()">Cerrar</button>
            <button class="mt-4 bg-green-500 text-white px-4 py-2 rounded hover:bg-blue-600 mx-1"
              routerLink="/pricing">Subscribirse</button>
          </div>
        </div>
      </div>
    </ng-template>
  </div>
</div>
